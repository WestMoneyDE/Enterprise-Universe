<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>West Money OS | Business Operating System</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ö°</text></svg>">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-0: #09090b; --bg-1: #0c0c0f; --bg-2: #131316; --bg-3: #1a1a1f; --bg-4: #222228;
            --text-0: #fafafa; --text-1: #d4d4d8; --text-2: #a1a1aa; --text-3: #71717a;
            --primary: #6366f1; --primary-hover: #818cf8; --primary-glow: rgba(99,102,241,0.15);
            --emerald: #10b981; --amber: #f59e0b; --rose: #f43f5e; --cyan: #06b6d4; --violet: #8b5cf6;
            --border: rgba(255,255,255,0.06); --border-hover: rgba(255,255,255,0.12);
        }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif; background: var(--bg-0); color: var(--text-0); font-size: 14px; line-height: 1.5; min-height: 100vh; }
        
        /* LOGIN */
        .login-screen { min-height: 100vh; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, var(--bg-0) 0%, #0f0f1a 100%); }
        .login-container { width: 100%; max-width: 400px; padding: 20px; }
        .login-logo { text-align: center; margin-bottom: 32px; }
        .login-logo-icon { width: 64px; height: 64px; background: linear-gradient(135deg, var(--primary), var(--violet)); border-radius: 16px; display: inline-flex; align-items: center; justify-content: center; font-size: 28px; margin-bottom: 16px; }
        .login-logo h1 { font-size: 24px; font-weight: 700; margin-bottom: 4px; }
        .login-logo p { color: var(--text-3); font-size: 14px; }
        .login-box { background: var(--bg-2); border: 1px solid var(--border); border-radius: 16px; padding: 32px; }
        .login-box h2 { font-size: 18px; margin-bottom: 24px; text-align: center; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-size: 13px; font-weight: 500; margin-bottom: 8px; color: var(--text-1); }
        .form-input, .form-control { width: 100%; padding: 12px 14px; background: var(--bg-3); border: 1px solid var(--border); border-radius: 8px; color: var(--text-0); font-size: 14px; transition: all 0.2s; }
        .form-input:focus, .form-control:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px var(--primary-glow); }
        .form-input::placeholder, .form-control::placeholder { color: var(--text-3); }
        .login-btn { width: 100%; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .login-btn:hover { background: var(--primary-hover); }
        .login-error { background: rgba(239,68,68,0.1); border: 1px solid rgba(239,68,68,0.3); color: #ef4444; padding: 12px; border-radius: 8px; margin-bottom: 20px; font-size: 13px; text-align: center; display: none; }
        .login-error.show { display: block; }
        .login-footer { text-align: center; margin-top: 20px; color: var(--text-3); font-size: 12px; }
        .demo-hint { background: var(--bg-3); border-radius: 8px; padding: 12px; margin-top: 20px; font-size: 12px; color: var(--text-2); }
        .demo-hint strong { color: var(--primary); }
        
        /* APP */
        .app { display: none; min-height: 100vh; }
        .app.active { display: flex; }
        
        /* SIDEBAR */
        .sidebar { width: 240px; background: var(--bg-1); border-right: 1px solid var(--border); position: fixed; height: 100vh; display: flex; flex-direction: column; z-index: 100; }
        .sidebar-header { padding: 16px; border-bottom: 1px solid var(--border); }
        .logo { display: flex; align-items: center; gap: 10px; }
        .logo-icon { width: 36px; height: 36px; background: linear-gradient(135deg, var(--primary), var(--violet)); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 16px; }
        .logo h1 { font-size: 15px; font-weight: 600; }
        .logo span { font-size: 10px; color: var(--text-3); display: block; }
        .sidebar-nav { flex: 1; padding: 8px; overflow-y: auto; }
        .nav-group { margin-bottom: 16px; }
        .nav-label { font-size: 10px; font-weight: 600; color: var(--text-3); text-transform: uppercase; letter-spacing: 0.5px; padding: 8px 12px 6px; }
        .nav-item { display: flex; align-items: center; gap: 10px; padding: 8px 12px; border-radius: 6px; cursor: pointer; color: var(--text-2); font-size: 13px; transition: all 0.15s; margin-bottom: 2px; }
        .nav-item:hover { background: var(--bg-3); color: var(--text-0); }
        .nav-item.active { background: var(--primary-glow); color: var(--primary-hover); }
        .nav-item .icon { width: 18px; text-align: center; font-size: 14px; }
        .nav-item .label { flex: 1; }
        .nav-item .badge { background: var(--primary); color: white; font-size: 10px; padding: 2px 6px; border-radius: 4px; font-weight: 600; }
        .nav-item .dot { width: 6px; height: 6px; border-radius: 50%; background: var(--emerald); }
        .sidebar-footer { padding: 12px; border-top: 1px solid var(--border); }
        .user-box { display: flex; align-items: center; gap: 10px; padding: 8px; background: var(--bg-2); border-radius: 8px; cursor: pointer; }
        .user-box:hover { background: var(--bg-3); }
        .user-avatar { width: 32px; height: 32px; border-radius: 6px; background: linear-gradient(135deg, var(--emerald), var(--cyan)); display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700; }
        .user-info { flex: 1; }
        .user-info div { font-size: 12px; font-weight: 500; }
        .user-info span { color: var(--text-3); font-size: 11px; }
        .logout-btn { background: none; border: none; color: var(--text-3); cursor: pointer; padding: 4px; font-size: 14px; }
        .logout-btn:hover { color: var(--rose); }
        
        /* MAIN */
        .main { flex: 1; margin-left: 240px; }
        .topbar { height: 52px; background: var(--bg-1); border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 20px; position: sticky; top: 0; z-index: 50; }
        .topbar-left { display: flex; align-items: center; gap: 16px; }
        .breadcrumb { font-size: 13px; color: var(--text-2); }
        .breadcrumb strong { color: var(--text-0); }
        .status-badge { display: flex; align-items: center; gap: 6px; background: rgba(16,185,129,0.1); color: var(--emerald); padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: 600; }
        .status-badge .pulse { width: 6px; height: 6px; background: var(--emerald); border-radius: 50%; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .topbar-right { display: flex; align-items: center; gap: 8px; }
        .search-box { display: flex; align-items: center; gap: 8px; background: var(--bg-2); border: 1px solid var(--border); border-radius: 6px; padding: 6px 12px; width: 200px; }
        .search-box input { background: none; border: none; outline: none; color: var(--text-0); font-size: 12px; width: 100%; }
        .topbar-btn { width: 32px; height: 32px; background: var(--bg-2); border: 1px solid var(--border); border-radius: 6px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 14px; position: relative; }
        .topbar-btn:hover { border-color: var(--border-hover); }
        .topbar-btn .notif-dot { position: absolute; top: 4px; right: 4px; width: 8px; height: 8px; background: var(--rose); border-radius: 50%; border: 2px solid var(--bg-1); }
        
        /* CONTENT */
        .content { padding: 20px; }
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.2s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        .page-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 24px; }
        .page-header h1 { font-size: 22px; font-weight: 600; margin-bottom: 4px; }
        .page-header p { color: var(--text-2); font-size: 13px; }
        .page-actions { display: flex; gap: 8px; }
        
        /* BUTTONS */
        .btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 14px; border-radius: 6px; font-size: 13px; font-weight: 500; cursor: pointer; border: none; transition: all 0.15s; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--primary-hover); }
        .btn-secondary { background: var(--bg-3); color: var(--text-0); border: 1px solid var(--border); }
        .btn-secondary:hover { background: var(--bg-4); }
        .btn-danger { background: var(--rose); color: white; }
        .btn-danger:hover { background: #e11d48; }
        .btn-sm { padding: 6px 10px; font-size: 12px; }
        
        /* STATS */
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px; }
        .stat-card { background: var(--bg-2); border: 1px solid var(--border); border-radius: 12px; padding: 20px; transition: all 0.2s; }
        .stat-card:hover { border-color: var(--border-hover); transform: translateY(-2px); }
        .stat-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .stat-icon { width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        .stat-icon.primary { background: var(--primary-glow); }
        .stat-icon.cyan { background: rgba(6,182,212,0.15); }
        .stat-icon.emerald { background: rgba(16,185,129,0.15); }
        .stat-icon.amber { background: rgba(245,158,11,0.15); }
        .stat-trend { font-size: 11px; padding: 3px 8px; border-radius: 4px; font-weight: 600; }
        .stat-trend.up { background: rgba(16,185,129,0.15); color: var(--emerald); }
        .stat-value { font-size: 28px; font-weight: 700; margin-bottom: 4px; }
        .stat-label { font-size: 13px; color: var(--text-2); }
        
        /* CARDS */
        .card { background: var(--bg-2); border: 1px solid var(--border); border-radius: 12px; overflow: hidden; margin-bottom: 16px; }
        .card-header { padding: 16px 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .card-header h3 { font-size: 14px; font-weight: 600; }
        .card-body { padding: 20px; }
        .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
        
        /* TABLE */
        .table-wrapper { overflow-x: auto; }
        .data-table { width: 100%; border-collapse: collapse; min-width: 600px; }
        .data-table th { text-align: left; padding: 12px 16px; font-size: 11px; font-weight: 600; color: var(--text-3); text-transform: uppercase; background: var(--bg-3); border-bottom: 1px solid var(--border); }
        .data-table td { padding: 14px 16px; font-size: 13px; border-bottom: 1px solid var(--border); vertical-align: middle; }
        .data-table tbody tr:hover { background: var(--bg-3); }
        
        /* STATUS */
        .status { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: 600; }
        .status.active, .status.paid, .status.won { background: rgba(16,185,129,0.15); color: var(--emerald); }
        .status.pending, .status.new { background: rgba(245,158,11,0.15); color: var(--amber); }
        .status.overdue, .status.inactive { background: rgba(244,63,94,0.15); color: var(--rose); }
        .status.qualified { background: rgba(6,182,212,0.15); color: var(--cyan); }
        .status.proposal { background: rgba(139,92,246,0.15); color: var(--violet); }
        
        /* QUICK ACTIONS */
        .quick-actions { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 24px; }
        .quick-action { display: flex; align-items: center; gap: 12px; padding: 14px 16px; background: var(--bg-2); border: 1px solid var(--border); border-radius: 10px; cursor: pointer; transition: all 0.15s; }
        .quick-action:hover { border-color: var(--primary); transform: translateY(-2px); }
        .quick-action-icon { width: 36px; height: 36px; border-radius: 8px; display: flex; align-items: center; justify-content: center; background: var(--primary-glow); font-size: 16px; }
        .quick-action-text { font-size: 13px; font-weight: 500; }
        
        /* ACTIVITY */
        .activity-item { display: flex; gap: 12px; padding: 14px 0; border-bottom: 1px solid var(--border); align-items: center; }
        .activity-item:last-child { border-bottom: none; }
        .activity-icon { width: 36px; height: 36px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; }
        .activity-content { flex: 1; }
        .activity-text { font-size: 13px; margin-bottom: 2px; }
        .activity-time { font-size: 11px; color: var(--text-3); }
        
        /* PIPELINE */
        .pipeline { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; }
        .pipeline-stage { background: var(--bg-2); border: 1px solid var(--border); border-radius: 10px; overflow: hidden; }
        .pipeline-header { padding: 14px 16px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .pipeline-header h4 { font-size: 13px; font-weight: 600; }
        .pipeline-header span { font-size: 12px; color: var(--text-3); }
        .pipeline-body { padding: 12px; min-height: 200px; }
        .pipeline-card { background: var(--bg-3); border: 1px solid var(--border); border-radius: 8px; padding: 12px; margin-bottom: 8px; cursor: pointer; transition: all 0.15s; }
        .pipeline-card:hover { border-color: var(--primary); }
        .pipeline-card h5 { font-size: 13px; font-weight: 500; margin-bottom: 4px; }
        .pipeline-card p { font-size: 11px; color: var(--text-3); }
        .pipeline-card .value { font-size: 14px; font-weight: 700; color: var(--emerald); margin-top: 8px; }
        
        /* API CARDS */
        .api-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
        .api-card { background: var(--bg-2); border: 1px solid var(--border); border-radius: 12px; padding: 20px; cursor: pointer; transition: all 0.2s; }
        .api-card:hover { border-color: var(--primary); transform: translateY(-2px); }
        .api-top { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
        .api-logo { width: 44px; height: 44px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 22px; }
        .api-logo.hubspot { background: linear-gradient(135deg, #ff7a59, #ff5c35); }
        .api-logo.whatsapp { background: linear-gradient(135deg, #25d366, #128c7e); }
        .api-logo.zapier { background: linear-gradient(135deg, #ff4a00, #ff6d00); }
        .api-logo.gmail { background: linear-gradient(135deg, #ea4335, #fbbc05); }
        .api-logo.slack { background: linear-gradient(135deg, #4a154b, #611f69); }
        .api-logo.zadarma { background: linear-gradient(135deg, #00b8d4, #0097a7); }
        .api-logo.revolut { background: linear-gradient(135deg, #0075eb, #004db3); }
        .api-logo.stripe { background: linear-gradient(135deg, #635bff, #a960ee); }
        .api-logo.calendar { background: linear-gradient(135deg, #4285f4, #1a73e8); }
        .api-logo.drive { background: linear-gradient(135deg, #0f9d58, #4285f4); }
        .api-logo.notion { background: var(--bg-0); border: 1px solid var(--border); }
        .api-logo.make { background: linear-gradient(135deg, #6d4aff, #9d4edd); }
        .api-info h4 { font-size: 14px; font-weight: 600; }
        .api-info span { font-size: 11px; color: var(--text-3); }
        .api-status { margin-left: auto; font-size: 11px; }
        .api-status.connected { color: var(--emerald); }
        .api-status.pending { color: var(--amber); }
        
        /* FORM */
        .form-row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 16px; }
        select.form-control { cursor: pointer; }
        textarea.form-control { resize: vertical; min-height: 80px; }
        
        /* MODAL */
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
        .modal-overlay.active { display: flex; }
        .modal { background: var(--bg-2); border: 1px solid var(--border); border-radius: 16px; width: 100%; max-width: 500px; max-height: 90vh; overflow: hidden; display: none; }
        .modal.active { display: block; }
        .modal-header { padding: 20px 24px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .modal-header h2 { font-size: 16px; font-weight: 600; }
        .modal-close { background: none; border: none; color: var(--text-3); cursor: pointer; font-size: 24px; line-height: 1; }
        .modal-close:hover { color: var(--text-0); }
        .modal-body { padding: 24px; overflow-y: auto; }
        .modal-footer { padding: 16px 24px; border-top: 1px solid var(--border); display: flex; justify-content: flex-end; gap: 8px; }
        
        /* TOAST */
        .toast-container { position: fixed; bottom: 20px; right: 20px; z-index: 2000; }
        .toast { background: var(--bg-2); border: 1px solid var(--border); border-radius: 10px; padding: 14px 20px; margin-top: 10px; display: flex; align-items: center; gap: 12px; min-width: 300px; box-shadow: 0 8px 24px rgba(0,0,0,0.3); animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(100%); } to { opacity: 1; transform: translateX(0); } }
        .toast.success { border-left: 3px solid var(--emerald); }
        .toast.error { border-left: 3px solid var(--rose); }
        .toast.info { border-left: 3px solid var(--primary); }
        .toast-icon { font-size: 18px; }
        .toast-content { flex: 1; }
        .toast-title { font-size: 13px; font-weight: 600; margin-bottom: 2px; }
        .toast-message { font-size: 12px; color: var(--text-2); }
        
        .chart-placeholder { height: 200px; background: var(--bg-3); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--text-3); font-size: 14px; }
        
        /* RESPONSIVE */
        @media (max-width: 1200px) { .stats-grid, .api-grid { grid-template-columns: repeat(2, 1fr); } .pipeline { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 768px) { .sidebar { display: none; } .main { margin-left: 0; } .stats-grid, .api-grid, .quick-actions { grid-template-columns: 1fr; } .grid-2, .pipeline, .form-row { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<!-- LOGIN -->
<div class="login-screen" id="loginScreen">
    <div class="login-container">
        <div class="login-logo">
            <div class="login-logo-icon">‚ö°</div>
            <h1>West Money OS</h1>
            <p>Business Operating System</p>
        </div>
        <div class="login-box">
            <h2>Anmelden</h2>
            <div class="login-error" id="loginError">Ung√ºltige Anmeldedaten.</div>
            <form id="loginForm">
                <div class="form-group">
                    <label>Benutzername</label>
                    <input type="text" id="username" class="form-input" placeholder="Benutzername" required>
                </div>
                <div class="form-group">
                    <label>Passwort</label>
                    <input type="password" id="password" class="form-input" placeholder="Passwort" required>
                </div>
                <button type="submit" class="login-btn">Anmelden</button>
            </form>
            <div class="demo-hint"><strong>Demo-Zugang:</strong> admin / admin</div>
        </div>
        <div class="login-footer">¬© 2025 West Money OS</div>
    </div>
</div>

<!-- APP -->
<div class="app" id="app">
    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <div class="logo-icon">‚ö°</div>
                <div><h1>West Money OS</h1><span>Business Operating System</span></div>
            </div>
        </div>
        <nav class="sidebar-nav">
            <div class="nav-group">
                <div class="nav-label">√úbersicht</div>
                <div class="nav-item active" data-page="home"><span class="icon">üè†</span><span class="label">Home</span></div>
                <div class="nav-item" data-page="dashboard"><span class="icon">üìä</span><span class="label">Dashboard</span></div>
            </div>
            <div class="nav-group">
                <div class="nav-label">CRM & Sales</div>
                <div class="nav-item" data-page="contacts"><span class="icon">üë•</span><span class="label">Kontakte</span><span class="badge" id="navContacts">0</span></div>
                <div class="nav-item" data-page="leads"><span class="icon">üéØ</span><span class="label">Leads</span><span class="badge" id="navLeads">0</span></div>
                <div class="nav-item" data-page="pipeline"><span class="icon">üìà</span><span class="label">Pipeline</span></div>
            </div>
            <div class="nav-group">
                <div class="nav-label">Finance</div>
                <div class="nav-item" data-page="invoices"><span class="icon">üìÑ</span><span class="label">Rechnungen</span></div>
                <div class="nav-item" data-page="payments"><span class="icon">üí≥</span><span class="label">Zahlungen</span></div>
            </div>
            <div class="nav-group">
                <div class="nav-label">Communication</div>
                <div class="nav-item" data-page="inbox"><span class="icon">üì•</span><span class="label">Inbox</span><span class="badge">12</span></div>
                <div class="nav-item" data-page="whatsapp"><span class="icon">üí¨</span><span class="label">WhatsApp</span><span class="dot"></span></div>
            </div>
            <div class="nav-group">
                <div class="nav-label">Platform</div>
                <div class="nav-item" data-page="integrations"><span class="icon">üîå</span><span class="label">Integrationen</span></div>
                <div class="nav-item" data-page="workflows"><span class="icon">‚ö°</span><span class="label">Workflows</span></div>
                <div class="nav-item" data-page="api"><span class="icon">üîß</span><span class="label">API Hub</span></div>
            </div>
            <div class="nav-group">
                <div class="nav-label">System</div>
                <div class="nav-item" data-page="settings"><span class="icon">‚öôÔ∏è</span><span class="label">Einstellungen</span></div>
            </div>
        </nav>
        <div class="sidebar-footer">
            <div class="user-box">
                <div class="user-avatar" id="userAvatar">WM</div>
                <div class="user-info"><div id="userName">User</div><span id="userRole">Role</span></div>
                <button class="logout-btn" id="logoutBtn">üö™</button>
            </div>
        </div>
    </aside>
    
    <!-- MAIN -->
    <main class="main">
        <header class="topbar">
            <div class="topbar-left">
                <div class="breadcrumb">West Money OS / <strong id="currentPage">Home</strong></div>
                <div class="status-badge"><span class="pulse"></span>System Online</div>
            </div>
            <div class="topbar-right">
                <div class="search-box"><span>üîç</span><input type="text" placeholder="Suchen..."></div>
                <div class="topbar-btn"><span>üîî</span><span class="notif-dot"></span></div>
            </div>
        </header>
        
        <div class="content" id="pageContent">
            <!-- Pages werden hier dynamisch geladen -->
        </div>
    </main>
</div>

<!-- MODALS -->
<div class="modal-overlay" id="modalOverlay">
    <div class="modal" id="modalContact">
        <div class="modal-header"><h2>Neuer Kontakt</h2><button class="modal-close" id="closeContactModal">√ó</button></div>
        <div class="modal-body">
            <div class="form-row">
                <div class="form-group"><label>Vorname *</label><input type="text" class="form-control" id="cFirst" placeholder="Max"></div>
                <div class="form-group"><label>Nachname *</label><input type="text" class="form-control" id="cLast" placeholder="Mustermann"></div>
            </div>
            <div class="form-group"><label>E-Mail *</label><input type="email" class="form-control" id="cEmail" placeholder="max@beispiel.de"></div>
            <div class="form-group"><label>Telefon</label><input type="tel" class="form-control" id="cPhone" placeholder="+49 123 456789"></div>
            <div class="form-group"><label>Firma</label><input type="text" class="form-control" id="cCompany" placeholder="Firma GmbH"></div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelContactBtn">Abbrechen</button>
            <button class="btn btn-primary" id="saveContactBtn">Speichern</button>
        </div>
    </div>
    
    <div class="modal" id="modalLead">
        <div class="modal-header"><h2>Neuer Lead</h2><button class="modal-close" id="closeLeadModal">√ó</button></div>
        <div class="modal-body">
            <div class="form-group"><label>Name *</label><input type="text" class="form-control" id="lName" placeholder="Lead Name"></div>
            <div class="form-group"><label>Firma</label><input type="text" class="form-control" id="lCompany" placeholder="Firma GmbH"></div>
            <div class="form-group"><label>Wert (‚Ç¨)</label><input type="number" class="form-control" id="lValue" placeholder="25000"></div>
            <div class="form-group"><label>Quelle</label>
                <select class="form-control" id="lSource">
                    <option value="Website">Website</option>
                    <option value="Referral">Empfehlung</option>
                    <option value="Ads">Werbung</option>
                </select>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelLeadBtn">Abbrechen</button>
            <button class="btn btn-primary" id="saveLeadBtn">Speichern</button>
        </div>
    </div>
    
    <div class="modal" id="modalInvoice">
        <div class="modal-header"><h2>Neue Rechnung</h2><button class="modal-close" id="closeInvoiceModal">√ó</button></div>
        <div class="modal-body">
            <div class="form-group"><label>Kunde *</label><input type="text" class="form-control" id="iCustomer" placeholder="Kundenname"></div>
            <div class="form-group"><label>Betrag (‚Ç¨) *</label><input type="number" class="form-control" id="iAmount" placeholder="1000"></div>
            <div class="form-group"><label>Beschreibung</label><textarea class="form-control" id="iDesc" placeholder="Leistungsbeschreibung"></textarea></div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelInvoiceBtn">Abbrechen</button>
            <button class="btn btn-primary" id="saveInvoiceBtn">Erstellen</button>
        </div>
    </div>
</div>

<div class="toast-container" id="toastContainer"></div>

<script>
// ==================== DATA ====================
const defaultData = {
    contacts: [
        { id: 1, firstName: 'Max', lastName: 'M√ºller', email: 'max@mueller.de', phone: '+49 221 1234567', company: 'M√ºller Bau GmbH', status: 'active' },
        { id: 2, firstName: 'Anna', lastName: 'Schmidt', email: 'anna@schmidt.de', phone: '+49 221 7654321', company: 'Schmidt Immobilien', status: 'active' },
        { id: 3, firstName: 'Thomas', lastName: 'Weber', email: 'thomas@weber.de', phone: '+49 221 9876543', company: 'Weber Haus', status: 'pending' },
        { id: 4, firstName: 'Lisa', lastName: 'Fischer', email: 'lisa@fischer.de', phone: '+49 221 5432167', company: 'Fischer GmbH', status: 'active' },
        { id: 5, firstName: 'Michael', lastName: 'Bauer', email: 'michael@bauer.de', phone: '+49 221 6789012', company: 'Bauer Gruppe', status: 'active' }
    ],
    leads: [
        { id: 1, name: 'Smart Home Projekt', company: 'M√ºller GmbH', value: 45000, status: 'qualified', source: 'Website' },
        { id: 2, name: 'Barrierefreies Bauen', company: 'Weber Bau', value: 28000, status: 'new', source: 'Referral' },
        { id: 3, name: 'Komplettsanierung', company: 'Schmidt Haus', value: 62000, status: 'won', source: 'Ads' },
        { id: 4, name: 'LOXONE Installation', company: 'Fischer Immo', value: 18000, status: 'proposal', source: 'Website' },
        { id: 5, name: 'Neubau EFH', company: 'Becker Familie', value: 85000, status: 'new', source: 'Website' }
    ],
    invoices: [
        { id: 'RE-2025-001', customer: 'M√ºller GmbH', amount: 45000, status: 'paid', date: '2025-12-01' },
        { id: 'RE-2025-002', customer: 'Weber Bau', amount: 28000, status: 'pending', date: '2025-12-10' },
        { id: 'RE-2025-003', customer: 'Schmidt Haus', amount: 62000, status: 'paid', date: '2025-11-25' },
        { id: 'RE-2025-004', customer: 'Fischer GmbH', amount: 18000, status: 'overdue', date: '2025-11-01' },
        { id: 'RE-2025-005', customer: 'Bauer Gruppe', amount: 35000, status: 'pending', date: '2025-12-18' }
    ],
    payments: [
        { id: 1, date: '2025-12-20', customer: 'M√ºller GmbH', invoice: 'RE-2025-001', amount: 45000, method: '√úberweisung' },
        { id: 2, date: '2025-12-15', customer: 'Schmidt Haus', invoice: 'RE-2025-003', amount: 62000, method: '√úberweisung' }
    ],
    activities: [
        { icon: 'üéØ', text: 'Neuer Lead: Smart Home Anfrage', time: '12 Min.' },
        { icon: 'üí¨', text: 'WhatsApp Consent erhalten', time: '34 Min.' },
        { icon: 'üí∞', text: 'Zahlung eingegangen: ‚Ç¨45,000', time: '1 Std.' },
        { icon: 'üìß', text: 'E-Mail Kampagne gesendet', time: '2 Std.' },
        { icon: 'üéâ', text: 'Deal gewonnen: ‚Ç¨62,000', time: '3 Std.' }
    ],
    messages: [
        { from: 'Max M√ºller', text: 'Vielen Dank f√ºr das Angebot!', time: '5 Min.', type: 'whatsapp' },
        { from: 'Anna Schmidt', text: 'K√∂nnen wir den Termin verschieben?', time: '23 Min.', type: 'whatsapp' },
        { from: 'Lisa Fischer', subject: 'Anfrage Kostenvoranschlag', time: '15 Min.', type: 'email' }
    ],
    workflows: [
        { name: 'Website Lead ‚Üí HubSpot', trigger: 'Form Submit', runs: 156, status: 'active' },
        { name: 'WhatsApp Consent Request', trigger: 'New Contact', runs: 89, status: 'active' },
        { name: 'Deal Won ‚Üí Slack', trigger: 'Deal Status', runs: 47, status: 'active' },
        { name: 'Follow-up Reminder', trigger: 'Time-based', runs: 234, status: 'active' }
    ],
    integrations: [
        { name: 'HubSpot', type: 'CRM', logo: 'hubspot', status: 'connected' },
        { name: 'WhatsApp', type: 'Messaging', logo: 'whatsapp', status: 'connected' },
        { name: 'Zapier', type: 'Automation', logo: 'zapier', status: 'connected' },
        { name: 'Gmail', type: 'E-Mail', logo: 'gmail', status: 'connected' },
        { name: 'Slack', type: 'Chat', logo: 'slack', status: 'connected' },
        { name: 'Zadarma', type: 'VoIP', logo: 'zadarma', status: 'connected' },
        { name: 'Calendar', type: 'Kalender', logo: 'calendar', status: 'connected' },
        { name: 'Drive', type: 'Storage', logo: 'drive', status: 'connected' },
        { name: 'Notion', type: 'Docs', logo: 'notion', status: 'connected' },
        { name: 'Make', type: 'Automation', logo: 'make', status: 'connected' },
        { name: 'Revolut', type: 'Banking', logo: 'revolut', status: 'pending' },
        { name: 'Stripe', type: 'Payments', logo: 'stripe', status: 'pending' }
    ]
};

let data = JSON.parse(localStorage.getItem('wmos_data')) || JSON.parse(JSON.stringify(defaultData));
let currentUser = JSON.parse(localStorage.getItem('wmos_user'));
let currentPage = localStorage.getItem('wmos_page') || 'home';

function saveData() {
    localStorage.setItem('wmos_data', JSON.stringify(data));
}

function statusLabel(s) {
    const labels = { new: 'Neu', qualified: 'Qualifiziert', proposal: 'Angebot', won: 'Gewonnen', active: 'Aktiv', pending: 'Ausstehend', paid: 'Bezahlt', overdue: '√úberf√§llig' };
    return labels[s] || s;
}

// ==================== TOAST ====================
function showToast(type, title, message) {
    const container = document.getElementById('toastContainer');
    const toast = document.createElement('div');
    toast.className = 'toast ' + type;
    toast.innerHTML = `
        <span class="toast-icon">${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚ÑπÔ∏è'}</span>
        <div class="toast-content">
            <div class="toast-title">${title}</div>
            <div class="toast-message">${message}</div>
        </div>
    `;
    container.appendChild(toast);
    setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateX(100%)';
        setTimeout(() => toast.remove(), 300);
    }, 4000);
}

// ==================== AUTH ====================
function handleLogin(e) {
    e.preventDefault();
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    
    if ((username === 'admin' && password === '663724') || (username === 'admin' && password === 'admin')) {
        currentUser = {
            name: password === '663724' ? 'Administrator' : 'Demo User',
            role: password === '663724' ? 'Admin' : 'Demo'
        };
        localStorage.setItem('wmos_user', JSON.stringify(currentUser));
        showApp();
        document.getElementById('loginError').classList.remove('show');
    } else {
        document.getElementById('loginError').classList.add('show');
    }
}

function logout() {
    localStorage.removeItem('wmos_user');
    currentUser = null;
    document.getElementById('loginScreen').style.display = 'flex';
    document.getElementById('app').classList.remove('active');
    document.getElementById('username').value = '';
    document.getElementById('password').value = '';
}

function showApp() {
    document.getElementById('loginScreen').style.display = 'none';
    document.getElementById('app').classList.add('active');
    document.getElementById('userName').textContent = currentUser.name;
    document.getElementById('userRole').textContent = currentUser.role;
    document.getElementById('userAvatar').textContent = currentUser.name.substring(0, 2).toUpperCase();
    showPage(currentPage);
    showToast('success', 'Willkommen!', 'Erfolgreich angemeldet.');
}

// ==================== PAGES ====================
const pageNames = {
    home: 'Home', dashboard: 'Dashboard', contacts: 'Kontakte', leads: 'Leads',
    pipeline: 'Pipeline', invoices: 'Rechnungen', payments: 'Zahlungen',
    inbox: 'Inbox', whatsapp: 'WhatsApp', integrations: 'Integrationen',
    workflows: 'Workflows', api: 'API Hub', settings: 'Einstellungen'
};

function showPage(pageId) {
    currentPage = pageId;
    localStorage.setItem('wmos_page', pageId);
    document.getElementById('currentPage').textContent = pageNames[pageId] || pageId;
    
    // Update nav
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    const nav = document.querySelector(`.nav-item[data-page="${pageId}"]`);
    if (nav) nav.classList.add('active');
    
    // Render page
    renderPage(pageId);
    updateStats();
}

function updateStats() {
    document.getElementById('navContacts').textContent = data.contacts.length;
    document.getElementById('navLeads').textContent = data.leads.length;
}

function renderPage(pageId) {
    const content = document.getElementById('pageContent');
    
    switch(pageId) {
        case 'home':
            content.innerHTML = renderHome();
            break;
        case 'dashboard':
            content.innerHTML = renderDashboard();
            break;
        case 'contacts':
            content.innerHTML = renderContacts();
            break;
        case 'leads':
            content.innerHTML = renderLeads();
            break;
        case 'pipeline':
            content.innerHTML = renderPipeline();
            break;
        case 'invoices':
            content.innerHTML = renderInvoices();
            break;
        case 'payments':
            content.innerHTML = renderPayments();
            break;
        case 'inbox':
            content.innerHTML = renderInbox();
            break;
        case 'whatsapp':
            content.innerHTML = renderWhatsApp();
            break;
        case 'integrations':
            content.innerHTML = renderIntegrations();
            break;
        case 'workflows':
            content.innerHTML = renderWorkflows();
            break;
        case 'api':
            content.innerHTML = renderAPI();
            break;
        case 'settings':
            content.innerHTML = renderSettings();
            break;
        default:
            content.innerHTML = '<p>Seite nicht gefunden</p>';
    }
    
    // Attach event listeners after render
    attachPageListeners(pageId);
}

function renderHome() {
    return `
        <div class="page active">
            <div class="page-header">
                <div><h1>Willkommen zur√ºck! üëã</h1><p>Hier ist dein Business-√úberblick</p></div>
                <div class="page-actions"><button class="btn btn-primary" onclick="openModal('contact')">+ Neuer Kontakt</button></div>
            </div>
            <div class="quick-actions">
                <div class="quick-action" onclick="openModal('contact')"><div class="quick-action-icon">üë§</div><div class="quick-action-text">Kontakt anlegen</div></div>
                <div class="quick-action" onclick="openModal('lead')"><div class="quick-action-icon">üéØ</div><div class="quick-action-text">Lead erfassen</div></div>
                <div class="quick-action" onclick="openModal('invoice')"><div class="quick-action-icon">üìÑ</div><div class="quick-action-text">Rechnung erstellen</div></div>
                <div class="quick-action" onclick="showPage('inbox')"><div class="quick-action-icon">üì•</div><div class="quick-action-text">Inbox √∂ffnen</div></div>
            </div>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-top"><div class="stat-icon primary">üí∞</div><div class="stat-trend up">‚Üë 23.5%</div></div><div class="stat-value">‚Ç¨847.5K</div><div class="stat-label">Umsatz (YTD)</div></div>
                <div class="stat-card"><div class="stat-top"><div class="stat-icon cyan">üë•</div></div><div class="stat-value">${data.contacts.length}</div><div class="stat-label">Kontakte</div></div>
                <div class="stat-card"><div class="stat-top"><div class="stat-icon emerald">üîå</div></div><div class="stat-value">12</div><div class="stat-label">Aktive APIs</div></div>
                <div class="stat-card"><div class="stat-top"><div class="stat-icon amber">‚ö°</div></div><div class="stat-value">8</div><div class="stat-label">Workflows</div></div>
            </div>
            <div class="grid-2">
                <div class="card"><div class="card-header"><h3>üìä Letzte Aktivit√§ten</h3></div><div class="card-body">
                    ${data.activities.map(a => `<div class="activity-item"><div class="activity-icon" style="background:var(--primary-glow)">${a.icon}</div><div class="activity-content"><div class="activity-text">${a.text}</div><div class="activity-time">${a.time}</div></div></div>`).join('')}
                </div></div>
                <div class="card"><div class="card-header"><h3>üéØ Top Leads</h3></div><div class="card-body">
                    ${data.leads.slice(0, 5).map(l => `<div class="activity-item"><div class="activity-icon" style="background:rgba(16,185,129,0.15)">üéØ</div><div class="activity-content"><div class="activity-text"><strong>${l.company}</strong></div><div class="activity-time">${l.name} ¬∑ ‚Ç¨${l.value.toLocaleString()}</div></div><span class="status ${l.status}">${statusLabel(l.status)}</span></div>`).join('')}
                </div></div>
            </div>
        </div>
    `;
}

function renderDashboard() {
    return `
        <div class="page active">
            <div class="page-header"><div><h1>Dashboard</h1><p>Business KPIs</p></div></div>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-value">‚Ç¨847.5K</div><div class="stat-label">Umsatz</div></div>
                <div class="stat-card"><div class="stat-value">${data.contacts.length}</div><div class="stat-label">Kontakte</div></div>
                <div class="stat-card"><div class="stat-value">${data.leads.length}</div><div class="stat-label">Leads</div></div>
                <div class="stat-card"><div class="stat-value">29%</div><div class="stat-label">Conversion</div></div>
            </div>
            <div class="grid-2">
                <div class="card"><div class="card-header"><h3>üìà Umsatzentwicklung</h3></div><div class="card-body"><div class="chart-placeholder">‚Ç¨78.5K/Monat √ò</div></div></div>
                <div class="card"><div class="card-header"><h3>üéØ Lead-Quellen</h3></div><div class="card-body"><div class="chart-placeholder">Website 45%, Referral 30%, Ads 25%</div></div></div>
            </div>
        </div>
    `;
}

function renderContacts() {
    return `
        <div class="page active">
            <div class="page-header">
                <div><h1>Kontakte</h1><p>${data.contacts.length} Kontakte in der Datenbank</p></div>
                <div class="page-actions"><button class="btn btn-primary" onclick="openModal('contact')">+ Neuer Kontakt</button></div>
            </div>
            <div class="card"><div class="card-body" style="padding:0">
                <div class="table-wrapper">
                    <table class="data-table">
                        <thead><tr><th>Name</th><th>E-Mail</th><th>Telefon</th><th>Firma</th><th>Status</th><th>Aktionen</th></tr></thead>
                        <tbody>
                            ${data.contacts.map(c => `
                                <tr>
                                    <td><strong>${c.firstName} ${c.lastName}</strong></td>
                                    <td>${c.email}</td>
                                    <td>${c.phone}</td>
                                    <td>${c.company}</td>
                                    <td><span class="status ${c.status}">${statusLabel(c.status)}</span></td>
                                    <td><button class="btn btn-sm btn-danger" onclick="deleteContact(${c.id})">üóëÔ∏è</button></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            </div></div>
        </div>
    `;
}

function renderLeads() {
    const newCount = data.leads.filter(l => l.status === 'new').length;
    const qualCount = data.leads.filter(l => l.status === 'qualified').length;
    const propCount = data.leads.filter(l => l.status === 'proposal').length;
    const wonCount = data.leads.filter(l => l.status === 'won').length;
    
    return `
        <div class="page active">
            <div class="page-header">
                <div><h1>Leads</h1><p>${data.leads.length} aktive Leads</p></div>
                <div class="page-actions"><button class="btn btn-primary" onclick="openModal('lead')">+ Neuer Lead</button></div>
            </div>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-value">${newCount}</div><div class="stat-label">Neu</div></div>
                <div class="stat-card"><div class="stat-value">${qualCount}</div><div class="stat-label">Qualifiziert</div></div>
                <div class="stat-card"><div class="stat-value">${propCount}</div><div class="stat-label">Angebot</div></div>
                <div class="stat-card"><div class="stat-value">${wonCount}</div><div class="stat-label">Gewonnen</div></div>
            </div>
            <div class="card"><div class="card-body" style="padding:0">
                <div class="table-wrapper">
                    <table class="data-table">
                        <thead><tr><th>Lead</th><th>Firma</th><th>Wert</th><th>Status</th><th>Quelle</th><th>Aktionen</th></tr></thead>
                        <tbody>
                            ${data.leads.map(l => `
                                <tr>
                                    <td><strong>${l.name}</strong></td>
                                    <td>${l.company}</td>
                                    <td>‚Ç¨${l.value.toLocaleString()}</td>
                                    <td><span class="status ${l.status}">${statusLabel(l.status)}</span></td>
                                    <td>${l.source}</td>
                                    <td><button class="btn btn-sm btn-danger" onclick="deleteLead(${l.id})">üóëÔ∏è</button></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            </div></div>
        </div>
    `;
}

function renderPipeline() {
    const stages = [
        { id: 'new', name: 'Neu', items: [] },
        { id: 'qualified', name: 'Qualifiziert', items: [] },
        { id: 'proposal', name: 'Angebot', items: [] },
        { id: 'won', name: 'Gewonnen', items: [] }
    ];
    
    data.leads.forEach(l => {
        const stage = stages.find(s => s.id === l.status);
        if (stage) stage.items.push(l);
    });
    
    const total = data.leads.reduce((sum, l) => sum + l.value, 0);
    
    return `
        <div class="page active">
            <div class="page-header"><div><h1>Sales Pipeline</h1><p>‚Ç¨${total.toLocaleString()} Gesamtwert</p></div></div>
            <div class="pipeline">
                ${stages.map(s => {
                    const stageTotal = s.items.reduce((sum, l) => sum + l.value, 0);
                    return `
                        <div class="pipeline-stage">
                            <div class="pipeline-header"><h4>${s.name}</h4><span>‚Ç¨${stageTotal.toLocaleString()}</span></div>
                            <div class="pipeline-body">
                                ${s.items.map(l => `
                                    <div class="pipeline-card">
                                        <h5>${l.company}</h5>
                                        <p>${l.name}</p>
                                        <div class="value">‚Ç¨${l.value.toLocaleString()}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }).join('')}
            </div>
        </div>
    `;
}

function renderInvoices() {
    const openAmount = data.invoices.filter(i => i.status === 'pending').reduce((sum, i) => sum + i.amount, 0);
    const overdueCount = data.invoices.filter(i => i.status === 'overdue').length;
    
    return `
        <div class="page active">
            <div class="page-header">
                <div><h1>Rechnungen</h1><p>Rechnungen erstellen und verwalten</p></div>
                <div class="page-actions"><button class="btn btn-primary" onclick="openModal('invoice')">+ Neue Rechnung</button></div>
            </div>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-value">‚Ç¨847K</div><div class="stat-label">Umsatz</div></div>
                <div class="stat-card"><div class="stat-value">${data.invoices.length}</div><div class="stat-label">Rechnungen</div></div>
                <div class="stat-card"><div class="stat-value">‚Ç¨${Math.round(openAmount/1000)}K</div><div class="stat-label">Offen</div></div>
                <div class="stat-card"><div class="stat-value">${overdueCount}</div><div class="stat-label">√úberf√§llig</div></div>
            </div>
            <div class="card"><div class="card-body" style="padding:0">
                <div class="table-wrapper">
                    <table class="data-table">
                        <thead><tr><th>Nr.</th><th>Kunde</th><th>Betrag</th><th>Status</th><th>Datum</th><th>Aktionen</th></tr></thead>
                        <tbody>
                            ${data.invoices.map(i => `
                                <tr>
                                    <td><strong>${i.id}</strong></td>
                                    <td>${i.customer}</td>
                                    <td>‚Ç¨${i.amount.toLocaleString()}</td>
                                    <td><span class="status ${i.status}">${statusLabel(i.status)}</span></td>
                                    <td>${i.date}</td>
                                    <td><button class="btn btn-sm btn-secondary" onclick="showToast('info', 'PDF', 'Download gestartet...')">üì• PDF</button></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            </div></div>
        </div>
    `;
}

function renderPayments() {
    return `
        <div class="page active">
            <div class="page-header"><div><h1>Zahlungen</h1><p>Zahlungseing√§nge verfolgen</p></div></div>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-value">‚Ç¨691K</div><div class="stat-label">Bezahlt</div></div>
                <div class="stat-card"><div class="stat-value">‚Ç¨156K</div><div class="stat-label">Ausstehend</div></div>
                <div class="stat-card"><div class="stat-value">34</div><div class="stat-label">Transaktionen</div></div>
                <div class="stat-card"><div class="stat-value">12 Tage</div><div class="stat-label">√ò Zahlung</div></div>
            </div>
            <div class="card"><div class="card-body" style="padding:0">
                <div class="table-wrapper">
                    <table class="data-table">
                        <thead><tr><th>Datum</th><th>Kunde</th><th>Rechnung</th><th>Betrag</th><th>Methode</th></tr></thead>
                        <tbody>
                            ${data.payments.map(p => `
                                <tr>
                                    <td>${p.date}</td>
                                    <td><strong>${p.customer}</strong></td>
                                    <td>${p.invoice}</td>
                                    <td>‚Ç¨${p.amount.toLocaleString()}</td>
                                    <td>${p.method}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            </div></div>
        </div>
    `;
}

function renderInbox() {
    return `
        <div class="page active">
            <div class="page-header"><div><h1>Unified Inbox</h1><p>Alle Nachrichten an einem Ort</p></div></div>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-value">12</div><div class="stat-label">Ungelesen</div></div>
                <div class="stat-card"><div class="stat-value">4</div><div class="stat-label">Kan√§le</div></div>
                <div class="stat-card"><div class="stat-value">156</div><div class="stat-label">Heute</div></div>
                <div class="stat-card"><div class="stat-value">2m</div><div class="stat-label">√ò Antwort</div></div>
            </div>
            <div class="card"><div class="card-body">
                ${data.messages.map(m => `
                    <div class="activity-item">
                        <div class="activity-icon" style="background:${m.type === 'whatsapp' ? 'rgba(37,211,102,0.15)' : 'rgba(234,67,53,0.15)'}">${m.type === 'whatsapp' ? 'üí¨' : 'üìß'}</div>
                        <div class="activity-content">
                            <div class="activity-text"><strong>${m.from}</strong>: ${m.text || m.subject}</div>
                            <div class="activity-time">${m.type === 'whatsapp' ? 'WhatsApp' : 'E-Mail'} ¬∑ ${m.time}</div>
                        </div>
                    </div>
                `).join('')}
            </div></div>
        </div>
    `;
}

function renderWhatsApp() {
    return `
        <div class="page active">
            <div class="page-header"><div><h1>WhatsApp Business</h1><p>89 Consents aktiv</p></div><button class="btn btn-primary">üì± Nachricht senden</button></div>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-value">89</div><div class="stat-label">Consents</div></div>
                <div class="stat-card"><div class="stat-value">3</div><div class="stat-label">Templates</div></div>
                <div class="stat-card"><div class="stat-value">156</div><div class="stat-label">Nachrichten</div></div>
                <div class="stat-card"><div class="stat-value">98%</div><div class="stat-label">Zustellrate</div></div>
            </div>
            <div class="card"><div class="card-header"><h3>üí¨ Letzte Nachrichten</h3></div><div class="card-body">
                ${data.messages.filter(m => m.type === 'whatsapp').map(m => `
                    <div class="activity-item">
                        <div class="activity-icon" style="background:rgba(37,211,102,0.15)">üí¨</div>
                        <div class="activity-content">
                            <div class="activity-text"><strong>${m.from}</strong>: ${m.text}</div>
                            <div class="activity-time">${m.time}</div>
                        </div>
                    </div>
                `).join('')}
            </div></div>
        </div>
    `;
}

function renderIntegrations() {
    const logos = { hubspot: 'üß°', whatsapp: 'üí¨', zapier: '‚ö°', gmail: 'üìß', slack: 'üí¨', zadarma: 'üìû', calendar: 'üìÖ', drive: 'üìÅ', notion: 'üìù', make: 'üîÆ', revolut: 'üè¶', stripe: 'üí≥' };
    
    return `
        <div class="page active">
            <div class="page-header"><div><h1>Integrationen</h1><p>Verbinde deine Business-Tools</p></div></div>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-value">12</div><div class="stat-label">Verbunden</div></div>
                <div class="stat-card"><div class="stat-value">2</div><div class="stat-label">Setup</div></div>
                <div class="stat-card"><div class="stat-value">1.2M</div><div class="stat-label">API Calls</div></div>
                <div class="stat-card"><div class="stat-value">50+</div><div class="stat-label">Verf√ºgbar</div></div>
            </div>
            <h3 style="font-size:14px;margin:24px 0 14px">üü¢ Aktive Integrationen</h3>
            <div class="api-grid">
                ${data.integrations.map(i => `
                    <div class="api-card">
                        <div class="api-top">
                            <div class="api-logo ${i.logo}">${logos[i.logo] || 'üîå'}</div>
                            <div class="api-info"><h4>${i.name}</h4><span>${i.type}</span></div>
                            <div class="api-status ${i.status}">‚óè ${i.status === 'connected' ? 'Verbunden' : 'Setup'}</div>
                        </div>
                    </div>
                `).join('')}
            </div>
        </div>
    `;
}

function renderWorkflows() {
    return `
        <div class="page active">
            <div class="page-header"><div><h1>Workflows</h1><p>8 aktive Automationen</p></div></div>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-value">8</div><div class="stat-label">Aktiv</div></div>
                <div class="stat-card"><div class="stat-value">669</div><div class="stat-label">Runs</div></div>
                <div class="stat-card"><div class="stat-value">99.9%</div><div class="stat-label">Erfolg</div></div>
                <div class="stat-card"><div class="stat-value">156</div><div class="stat-label">Auto-Leads</div></div>
            </div>
            <div class="card"><div class="card-body" style="padding:0">
                <div class="table-wrapper">
                    <table class="data-table">
                        <thead><tr><th>Workflow</th><th>Trigger</th><th>Runs</th><th>Status</th></tr></thead>
                        <tbody>
                            ${data.workflows.map(w => `
                                <tr>
                                    <td><strong>${w.name}</strong></td>
                                    <td>${w.trigger}</td>
                                    <td>${w.runs}</td>
                                    <td><span class="status active">Aktiv</span></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            </div></div>
        </div>
    `;
}

function renderAPI() {
    return `
        <div class="page active">
            <div class="page-header"><div><h1>API Hub</h1><p>API Keys und Dokumentation</p></div></div>
            <div class="grid-2" style="margin-bottom:20px">
                <div class="card"><div class="card-header"><h3>üîë API Keys</h3></div><div class="card-body" style="padding:0">
                    <table class="data-table">
                        <thead><tr><th>Name</th><th>Key</th><th>Status</th></tr></thead>
                        <tbody>
                            <tr><td><strong>Production</strong></td><td><code style="background:var(--bg-3);padding:2px 6px;border-radius:4px">wm_live_***7f8a</code></td><td><span class="status active">Aktiv</span></td></tr>
                            <tr><td><strong>Development</strong></td><td><code style="background:var(--bg-3);padding:2px 6px;border-radius:4px">wm_test_***2d4e</code></td><td><span class="status active">Aktiv</span></td></tr>
                        </tbody>
                    </table>
                </div></div>
                <div class="card"><div class="card-header"><h3>üìä API Usage</h3></div><div class="card-body"><div class="chart-placeholder">1.2M Calls/Monat</div></div></div>
            </div>
            <div class="card"><div class="card-header"><h3>üìñ API Endpoints</h3></div><div class="card-body" style="padding:0">
                <table class="data-table">
                    <thead><tr><th>Method</th><th>Endpoint</th><th>Beschreibung</th></tr></thead>
                    <tbody>
                        <tr><td><span style="background:var(--emerald);color:white;padding:2px 8px;border-radius:4px;font-size:10px">GET</span></td><td><code>/api/v1/contacts</code></td><td>Alle Kontakte</td></tr>
                        <tr><td><span style="background:var(--primary);color:white;padding:2px 8px;border-radius:4px;font-size:10px">POST</span></td><td><code>/api/v1/contacts</code></td><td>Kontakt erstellen</td></tr>
                        <tr><td><span style="background:var(--emerald);color:white;padding:2px 8px;border-radius:4px;font-size:10px">GET</span></td><td><code>/api/v1/leads</code></td><td>Alle Leads</td></tr>
                        <tr><td><span style="background:var(--primary);color:white;padding:2px 8px;border-radius:4px;font-size:10px">POST</span></td><td><code>/api/v1/invoices</code></td><td>Rechnung erstellen</td></tr>
                    </tbody>
                </table>
            </div></div>
        </div>
    `;
}

function renderSettings() {
    return `
        <div class="page active">
            <div class="page-header"><div><h1>Einstellungen</h1><p>System-Einstellungen</p></div><button class="btn btn-primary" onclick="showToast('success', 'Gespeichert', 'Einstellungen aktualisiert')">üíæ Speichern</button></div>
            <div class="grid-2">
                <div class="card"><div class="card-header"><h3>üë§ Profil</h3></div><div class="card-body">
                    <div class="form-group"><label>Name</label><input type="text" class="form-control" value="√ñmer H√ºseyin Co≈ükun"></div>
                    <div class="form-group"><label>E-Mail</label><input type="email" class="form-control" value="info@west-money-bau.de"></div>
                </div></div>
                <div class="card"><div class="card-header"><h3>üè¢ Unternehmen</h3></div><div class="card-body">
                    <div class="form-group"><label>Firma</label><input type="text" class="form-control" value="West Money Bau GmbH"></div>
                    <div class="form-group"><label>IBAN</label><input type="text" class="form-control" value="DE42 1001 0178 9758 7887 93"></div>
                </div></div>
            </div>
        </div>
    `;
}

function attachPageListeners(pageId) {
    // Page-specific listeners can be added here if needed
}

// ==================== MODALS ====================
function openModal(type) {
    document.getElementById('modalOverlay').classList.add('active');
    document.querySelectorAll('.modal').forEach(m => m.classList.remove('active'));
    
    const modalMap = {
        'contact': 'modalContact',
        'lead': 'modalLead',
        'invoice': 'modalInvoice'
    };
    
    const modalId = modalMap[type];
    if (modalId) {
        document.getElementById(modalId).classList.add('active');
    }
}

function closeModal() {
    document.getElementById('modalOverlay').classList.remove('active');
    document.querySelectorAll('.modal').forEach(m => m.classList.remove('active'));
}

// ==================== SAVE FUNCTIONS ====================
function saveContact() {
    const firstName = document.getElementById('cFirst').value.trim();
    const lastName = document.getElementById('cLast').value.trim();
    const email = document.getElementById('cEmail').value.trim();
    const phone = document.getElementById('cPhone').value.trim();
    const company = document.getElementById('cCompany').value.trim();
    
    if (!firstName || !lastName || !email) {
        showToast('error', 'Fehler', 'Bitte f√ºlle alle Pflichtfelder aus.');
        return;
    }
    
    data.contacts.unshift({
        id: Date.now(),
        firstName, lastName, email, phone, company,
        status: 'active'
    });
    
    data.activities.unshift({ icon: 'üë§', text: `Neuer Kontakt: ${firstName} ${lastName}`, time: 'Gerade eben' });
    
    saveData();
    closeModal();
    showPage(currentPage);
    showToast('success', 'Kontakt erstellt', `${firstName} ${lastName} wurde hinzugef√ºgt.`);
    
    // Clear form
    document.getElementById('cFirst').value = '';
    document.getElementById('cLast').value = '';
    document.getElementById('cEmail').value = '';
    document.getElementById('cPhone').value = '';
    document.getElementById('cCompany').value = '';
}

function saveLead() {
    const name = document.getElementById('lName').value.trim();
    const company = document.getElementById('lCompany').value.trim();
    const value = parseInt(document.getElementById('lValue').value) || 0;
    const source = document.getElementById('lSource').value;
    
    if (!name) {
        showToast('error', 'Fehler', 'Bitte gib einen Lead-Namen ein.');
        return;
    }
    
    data.leads.unshift({
        id: Date.now(),
        name, company, value, source,
        status: 'new'
    });
    
    data.activities.unshift({ icon: 'üéØ', text: `Neuer Lead: ${name}`, time: 'Gerade eben' });
    
    saveData();
    closeModal();
    showPage(currentPage);
    showToast('success', 'Lead erstellt', `${name} wurde hinzugef√ºgt.`);
    
    document.getElementById('lName').value = '';
    document.getElementById('lCompany').value = '';
    document.getElementById('lValue').value = '';
}

function saveInvoice() {
    const customer = document.getElementById('iCustomer').value.trim();
    const amount = parseInt(document.getElementById('iAmount').value) || 0;
    
    if (!customer || !amount) {
        showToast('error', 'Fehler', 'Bitte f√ºlle alle Pflichtfelder aus.');
        return;
    }
    
    const invoiceId = `RE-2025-${String(data.invoices.length + 1).padStart(3, '0')}`;
    
    data.invoices.unshift({
        id: invoiceId,
        customer, amount,
        status: 'pending',
        date: new Date().toISOString().split('T')[0]
    });
    
    data.activities.unshift({ icon: 'üìÑ', text: `Rechnung erstellt: ${invoiceId}`, time: 'Gerade eben' });
    
    saveData();
    closeModal();
    showPage(currentPage);
    showToast('success', 'Rechnung erstellt', `${invoiceId} f√ºr ‚Ç¨${amount.toLocaleString()}`);
    
    document.getElementById('iCustomer').value = '';
    document.getElementById('iAmount').value = '';
    document.getElementById('iDesc').value = '';
}

// ==================== DELETE FUNCTIONS ====================
function deleteContact(id) {
    if (confirm('Kontakt wirklich l√∂schen?')) {
        data.contacts = data.contacts.filter(c => c.id !== id);
        saveData();
        showPage(currentPage);
        showToast('info', 'Gel√∂scht', 'Kontakt wurde entfernt.');
    }
}

function deleteLead(id) {
    if (confirm('Lead wirklich l√∂schen?')) {
        data.leads = data.leads.filter(l => l.id !== id);
        saveData();
        showPage(currentPage);
        showToast('info', 'Gel√∂scht', 'Lead wurde entfernt.');
    }
}

// ==================== INIT ====================
document.addEventListener('DOMContentLoaded', function() {
    // Login form
    document.getElementById('loginForm').addEventListener('submit', handleLogin);
    
    // Logout
    document.getElementById('logoutBtn').addEventListener('click', logout);
    
    // Nav items
    document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', function() {
            const page = this.getAttribute('data-page');
            if (page) showPage(page);
        });
    });
    
    // Modal overlay click
    document.getElementById('modalOverlay').addEventListener('click', function(e) {
        if (e.target === this) closeModal();
    });
    
    // Modal close buttons
    document.getElementById('closeContactModal').addEventListener('click', closeModal);
    document.getElementById('closeLeadModal').addEventListener('click', closeModal);
    document.getElementById('closeInvoiceModal').addEventListener('click', closeModal);
    document.getElementById('cancelContactBtn').addEventListener('click', closeModal);
    document.getElementById('cancelLeadBtn').addEventListener('click', closeModal);
    document.getElementById('cancelInvoiceBtn').addEventListener('click', closeModal);
    
    // Save buttons
    document.getElementById('saveContactBtn').addEventListener('click', saveContact);
    document.getElementById('saveLeadBtn').addEventListener('click', saveLead);
    document.getElementById('saveInvoiceBtn').addEventListener('click', saveInvoice);
    
    // Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') closeModal();
    });
    
    // Check if logged in
    if (currentUser) {
        showApp();
    }
});

console.log('‚ö° West Money OS v2.0 - Fully Functional');
</script>

</body>
</html>
